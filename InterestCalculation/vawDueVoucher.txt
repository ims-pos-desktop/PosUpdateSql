CREATE OR ALTER VIEW [dbo].[vawDueVoucher]
AS
SELECT I.VCHRNO, I.TRNDATE, I.BSDATE, I.NETAMNT - ISNULL(A.PARTRNAMNT, 0) NETAMNT, I.TRNAC,A.CREBATE IntRate,A.PARTRNAMNT Downpayment FROM INVMAIN I left join Accmain A on I.VCHRNO = A.REFORDBILL
WHERE I.TRNMODE = 'CREDIT'  AND I.VOUCHERTYPE = 'DL'
UNION
SELECT T.VCHRNO, T.TRNDATE, T.BSDATE, T.NETAMNT, T.TRNAC, 0 IntRate, 0 Downpayment FROM TRNMAIN T LEFT JOIN INVMAIN I ON T.REFBILL = I.VCHRNO
WHERE T.TRNMODE = 'CREDIT' AND T.VoucherType = 'TI'  AND I.VCHRNO IS NULL 