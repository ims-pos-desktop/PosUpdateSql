CREATE OR ALTER VIEW vwSchemeItems
AS
SELECT COALESCE(M.MENUCODE, MP.MENUCODE, MG.MENUCODE) MENUCODE, COALESCE(M.DESCA, MP.DESCA, MG.DESCA) DESCA, COALESCE(M.RATE_A, MP.RATE_A, MG.RATE_A) SellingRate, COALESCE(M.VAT, MP.VAT, MG.VAT) Vatable, SD.DisID, SD.MGroup, SD.Parent, SD.Mcode, SD.DisRate, SD.DisAmount, SD.VAT, SD.STAMP, SD.TRNUSER, SD.IsActive FROM Discount_SchemeDiscount SD 
LEFT JOIN MENUITEM M ON SD.Mcode = M.MCODE
LEFT JOIN MENUITEM MP ON SD.Parent = MP.PARENT
LEFT JOIN MENUITEM MG ON SD.MGroup = MG.MGROUP