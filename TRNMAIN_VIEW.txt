CREATE OR ALTER VIEW [dbo].[TRNMAIN_VIEW]
AS
SELECT A.VCHRNO, A.DIVISION,A.CHALANNO,A.TRNDATE,A.BSDATE,A.TRNTIME,TRNMODE,TRNAC,B.ACNAME,REMARKS,TERMINAL,MEMBERNO,
CASE WHEN LEFT(A.VCHRNO,2) IN ('SR','CN','PR','IR','RE') THEN TOTAMNT *-1 ELSE TOTAMNT END AS TOTAMNT,
CASE WHEN LEFT(A.VCHRNO,2) IN ('SR','CN','PR','IR','RE') THEN DCAMNT *-1 ELSE DCAMNT END AS DCAMNT,TOTALLOYALTY,
CASE WHEN LEFT(A.VCHRNO,2) IN ('SR','CN','PR','IR','RE') THEN VATAMNT *-1 ELSE VATAMNT END AS VATAMNT,
CASE WHEN LEFT(A.VCHRNO,2) IN ('SR','CN','PR','IR','RE') THEN NETAMNT *-1 ELSE NETAMNT END AS NETAMNT,
CASE WHEN LEFT(A.VCHRNO,2) IN ('SR','CN','PR','IR','RE') THEN TAXABLE *-1 ELSE TAXABLE END AS TAXABLE,
CASE WHEN LEFT(A.VCHRNO,2) IN ('SR','CN','PR','IR','RE') THEN NONTAXABLE *-1 ELSE NONTAXABLE END AS NONTAXABLE,
A.PHISCALID,ISNULL(A.VNUM,A.VCHRNO)VNUM
FROM RMD_TRNMAIN A LEFT JOIN RMD_ACLIST B
ON A.TRNAC = B.ACID


