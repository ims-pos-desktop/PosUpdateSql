CREATE OR ALTER   PROCEDURE [dbo].[TertiarySalesDetail]
@DATE1 DATE,@DATE2 DATE
AS
--DECLARE @DATE1 DATE ='17-JUL-2019',@DATE2 DATE = '17-SEP-2019'
SELECT G.MAHINANAME,G.GATE +'/' + G.MAHINA + '/' + G.SAL [BS],DATENAME(DW,TRNDATE) [DAY],BILLTO AS CUSTOMER,H.MOBILENO AS [CONTACTNO],A.VCHRNO BILLNO,C.DESCA DESIGNCODE,C.MCODE SKU,D.DESCA PRODUCT,
F.SIZE,C.RATE_A [MRP],B.DISCOUNT,C.MCAT SEASON,RealQty QTY,B.DISCOUNT DISCOUNTAMOUNT,b.amount,b.AMOUNT-b.DISCOUNT [Net Realization]
FROM RMD_TRNMAIN A INNER JOIN RMD_SALESPROD B ON 
A.VCHRNO=B.VCHRNO AND A.DIVISION=B.DIVISION AND A.PHISCALID=B.PHISCALID
INNER JOIN MENUITEM C ON B.MCODE= C.MCODE
INNER JOIN MENUITEM D ON C.MGROUP = D.MCODE
LEFT JOIN BARCODE E ON B.MCODE= E.MCODE AND B.BC=E.BCODE
LEFT JOIN BARCODE_DETAIL F ON E.BCODE=F.BARCODE AND E.MCODE= F.MCODE
LEFT JOIN DATEMITI_FULL G ON A.TRNDATE=G.AD
LEFT JOIN CUSTOMERPROFILE H ON A.RECEIVEBY = H.CUSTID
where a.VoucherType in ('SI','TI') AND A.TRNDATE BETWEEN @DATE1 AND @DATE2
ORDER BY TRNDATE

