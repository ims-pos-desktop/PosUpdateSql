CREATE  OR ALTER     PROC [dbo].[RSP_VEHICLESALESREGISTER]
@DATE1 AS DATETIME,
@DATE2 AS DATETIME,
@TERMINAL AS VARCHAR(25) = '%'
AS
	SELECT DBO.GETNEPALIMONTH(SUBSTRING(A.BSDATE, 4,2)) AS MONTH, 
	A.VCHRNO AS BILL_NO,
	A.REFBILL AS DEL_CHALAN ,
	AA.TRNDATE AS DEL_DATE,
	AA.BSDATE AS DEL_MITI,
	A.TRNDATE AS SALES_DATE, 
	A.BSDATE AS SALES_MITI,
	CONVERT(DECIMAL(10,2), A.TOTAMNT) AS GROSSAMT,
	CONVERT(DECIMAL(10,2),A.DCAMNT) AS DISAMT,
	CONVERT(DECIMAL(10,2),A.NETAMNT/1.13) AS TAXABLE,
	CONVERT(DECIMAL(10,2),A.VATAMNT) AS VAT, 
	CONVERT(DECIMAL(10,2), A.NETAMNT) AS NETAMT,
	E.ACNAME AS AC_LEDGER, 
	A.PRESCRIBEBY AS CUSTOMER_FINANCE_NAME_ONBILL, 
	A.BILLTOADD AS PANNO_ONBILL, 
	A.BILLTOADD AS BUYER_NAME_ONBILL_OR_DEL_CHALAN, 
	AA.BILLTOTEL  AS ADDRESS, 
	C.VEHICLEENGINENO AS ENGINENO, 
	C.VEHICLECHASISNO,
	BB.DESCA AS ITEM_NAME,
	C.VEHICLEMODEL, 
	C.VEHICLEREGISTRATIONNO, 
	C.COLOR,A.REMARKS,
	A.PARAC AS CUSTOMER_ID  
	FROM RMD_TRNMAIN A 
	INNER  JOIN  RMD_TRNPROD B ON  A.VCHRNO = B.VCHRNO  
	LEFT JOIN  BARCODE_DETAIL C ON B.BC = C.BARCODE 
	LEFT JOIN RMD_ACLIST E ON A.TRNAC = E.ACID 
	LEFT JOIN RMD_TRNMAIN AA ON A.REFBILL = AA.VCHRNO 
	LEFT JOIN MENUITEM BB ON B.MCODE = BB.MCODE 
	WHERE BB.PTYPE = 4 AND LEFT (A.VCHRNO,2) IN ('TI') AND ACNAME LIKE '%'  AND C.VEHICLECHASISNO 
	IS NOT NULL AND A.TRNDATE  BETWEEN @DATE1 AND @DATE2
	ORDER BY  CAST(SUBSTRING(A.VNUM,3,LEN(A.VCHRNO)) AS NUMERIC)

