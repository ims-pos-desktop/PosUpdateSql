CREATE OR ALTER FUNCTION fnPartyFilter(@AREA_ID INT = 0,@CATEGORY_ID INT = 0, @ACID VARCHAR(25) = '%', @FP2 BIT  = 0, @FP3 BIT  = 0, @FP4 BIT  = 0, @FP5 BIT  = 0, @FP6 BIT  = 0)
RETURNS  TABLE 
AS
RETURN
(
	SELECT DISTINCT RA.*, TA.AREA_NAME, TP.CATEGORY_NAME 
	FROM RMD_ACLIST RA 
	LEFT JOIN tblArea TA ON TA.AREA_ID=RA.AREA_ID 
	LEFT JOIN tblPartyCategory TP ON RA.CATEGORY_ID=TP.CATEGORY_ID
	WHERE (@ACID = '%' OR ACID IN (select * from dbo.Split(@ACID,','))) AND (@AREA_ID = 0 OR COALESCE(RA.AREA_ID,0) = @AREA_ID) 
	AND (@CATEGORY_ID = 0 OR COALESCE(RA.CATEGORY_ID,0) = @CATEGORY_ID)
)
