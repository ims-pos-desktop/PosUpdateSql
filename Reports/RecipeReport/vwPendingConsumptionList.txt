CREATE OR ALTER  VIEW [dbo].[vwPendingConsumptionList]
AS
SELECT ROW_NUMBER() OVER (ORDER BY STAMP) SNO, VCHRNO, DIVISION, TRNDATE, TRNTIME, BILLTO, NETAMNT FROM
(
	SELECT DISTINCT A.VCHRNO, A.DIVISION, A.TRNDATE, A.TRNTIME, A.BILLTO, A.NETAMNT, A.Stamp FROM SALES_TRNMAIN A 
	JOIN SALES_TRNPROD P ON A.VCHRNO = P.VCHRNO
	JOIN MENUITEM MI ON P.MCODE = MI.MCODE
	JOIN RECEIPEMAIN RM ON P.MCODE = RM.MCODE
	LEFT JOIN INVMAIN B ON A.VCHRNO = B.REFBILL
	WHERE B.VCHRNO IS NULL AND MI.PTYPE = 10
) A