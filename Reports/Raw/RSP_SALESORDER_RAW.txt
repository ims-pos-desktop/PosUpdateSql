CREATE OR ALTER PROC RSP_SALESORDER_RAW
@DATE1 DATETIME,
@DATE2 DATETIME,
@DIVISION VARCHAR(3) = '%'
AS
SELECT OM.TRNDATE, OM.BSDATE, D.NAME Branch, OM.VCHRNO, OM.CHALANNO, A.ACNAME PARTY,OM.TRNUSER, OM.DELIVERYADDRESS, OM.MOBILENO
, IH.[Main Group], IH.[Main Category], IH.[Sub Category], IH.[Super Category], MI.MENUCODE [Item Code], MI.DESCA [Item Name]
, OP.BC Barcode, OP.ALTUNIT Unit, OP.ALTQTY_IN Quantity, OP.ALTRATE Rate, OP.AMOUNT
FROM RMD_ORDERMAIN OM JOIN RMD_ORDERPROD OP ON OM.VCHRNO = OP.VCHRNO
JOIN MENUITEM MI ON MI.MCODE = OP.MCODE
JOIN vwItemHeirarchy IH ON MI.MCODE = IH.MCODE
JOIN DIVISION D ON OM.DIVISION = D.INITIAL
LEFT JOIN RMD_ACLIST A ON OM.TRNAC = A.ACID
WHERE OM.VCHRNO LIKE 'SO%' AND OM.DIVISION LIKE @DIVISION AND OM.TRNDATE BETWEEN @DATE1 AND @DATE2
ORDER BY OM.TRNDATE, D.NAME, OM.VCHRNO