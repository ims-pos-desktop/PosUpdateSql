CREATE OR ALTER FUNCTION [dbo].[RMD_TRNMAIN_FN] (@GRNWISE TINYINT, @PhiscalId VARCHAR(25) = '%')
RETURNS  TABLE 
AS
RETURN
(
	SELECT  VCHRNO, DIVISION, CHALANNO, TRNDATE, BSDATE, TRNTIME, TOTAMNT, DCAMNT, DCRATE, VATAMNT, NETAMNT, ADVANCE, TRNMODE, BILLTO, BILLTOADD, TRNUSER, VATBILL, DELIVERYDATE, 
	DELIVERYTIME, ORDERS, REFORDBILL, INDDIS, CREBATE, CREDIT, DUEDATE, TRNAC, PARAC, PARTRNAMNT, RETTO, REFBILL, CHEQUENO, CHEQUEDATE, REMARKS, POST, POSTUSER, FPOSTUSER, 
	TERMINAL, SHIFT, EXPORT, CHOLDER, CARDNO, EditUser, MEMBERNO, MEMBERNAME, EDITED, TAXABLE, NONTAXABLE, VMODE, BILLTOTEL, BILLTOMOB, TRN_DATE, BS_DATE, STAX, TOTALCASH, 
	TOTALCREDIT, TOTALCREDITCARD, TOTALGIFTVOUCHER, TENDER, CHANGE, CardTranID, ReturnVchrID, TranID, VoucherStatus, VoucherType, PRESCRIBEBY, DISPENSEBY, RECEIVEBY, Edate, STATUS, 
	CONFIRMEDBY, CONFIRMEDTIME, PhiscalID, Stamp, ROUNDOFF, Customer_Count, DBUSER, HOSTID, VNUM, TOTALREBATE, DISVALUE, STAXVALUE, COSTCENTER, TOTALFLATDISCOUNT, TOTALINDDISCOUNT, 
	TOTALLOYALTY, TOTALPROMOTION, NETWITHOUTROUNDOFF, guid, JOBNO, MWAREHOUSE, POSTID
	FROM    dbo.ABBMAIN WITH (NOLOCK)	WHERE PhiscalId	LIKE @PhiscalId

	UNION ALL
	SELECT  VCHRNO, DIVISION, CHALANNO, TRNDATE, BSDATE, TRNTIME, TOTAMNT, DCAMNT, DCRATE, VATAMNT, NETAMNT, ADVANCE, TRNMODE, BILLTO, BILLTOADD, TRNUSER, VATBILL, DELIVERYDATE, 
	DELIVERYTIME, ORDERS, REFORDBILL, INDDIS, CREBATE, CREDIT, DUEDATE, TRNAC, PARAC, PARTRNAMNT, RETTO, REFBILL, CHEQUENO, CHEQUEDATE, REMARKS, POST, POSTUSER, FPOSTUSER, 
	TERMINAL, SHIFT, EXPORT, CHOLDER, CARDNO, EditUser, MEMBERNO, MEMBERNAME, EDITED, TAXABLE, NONTAXABLE, VMODE, BILLTOTEL, BILLTOMOB, TRN_DATE, BS_DATE, STAX, TOTALCASH, 
	TOTALCREDIT, TOTALCREDITCARD, TOTALGIFTVOUCHER, TENDER, CHANGE, CardTranID, ReturnVchrID, TranID, VoucherStatus, VoucherType, PRESCRIBEBY, DISPENSEBY, RECEIVEBY, Edate, STATUS, 
	CONFIRMEDBY, CONFIRMEDTIME, PhiscalID, Stamp, ROUNDOFF, Customer_Count, DBUSER, HOSTID, VNUM, TOTALREBATE, DISVALUE, STAXVALUE, COSTCENTER, TOTALFLATDISCOUNT, TOTALINDDISCOUNT, 
	TOTALLOYALTY, TOTALPROMOTION, NETWITHOUTROUNDOFF, guid, JOBNO, MWAREHOUSE, POSTID
	FROM    dbo.TRNMAIN WITH (NOLOCK) WHERE PhiscalId	LIKE @PhiscalId  

	UNION ALL
	SELECT  VCHRNO, DIVISION, CHALANNO, TRNDATE, BSDATE, TRNTIME, TOTAMNT, DCAMNT, DCRATE, VATAMNT, NETAMNT, ADVANCE, TRNMODE, BILLTO, BILLTOADD, TRNUSER, VATBILL, DELIVERYDATE, 
	DELIVERYTIME, ORDERS, REFORDBILL, INDDIS, CREBATE, CREDIT, DUEDATE, TRNAC, PARAC, PARTRNAMNT, RETTO, REFBILL, CHEQUENO, CHEQUEDATE, REMARKS, POST, POSTUSER, FPOSTUSER, 
	TERMINAL, SHIFT, EXPORT, CHOLDER, CARDNO, EditUser, MEMBERNO, MEMBERNAME, EDITED, TAXABLE, NONTAXABLE, VMODE, BILLTOTEL, BILLTOMOB, TRN_DATE, BS_DATE, STAX, TOTALCASH, 
	TOTALCREDIT, TOTALCREDITCARD, TOTALGIFTVOUCHER, TENDER, CHANGE, CardTranID, ReturnVchrID, TranID, VoucherStatus, VoucherType, PRESCRIBEBY, DISPENSEBY, RECEIVEBY, Edate, STATUS, 
	CONFIRMEDBY, CONFIRMEDTIME, PhiscalID, Stamp, ROUNDOFF, Customer_Count, DBUSER, HOSTID, VNUM, TOTALREBATE, DISVALUE, STAXVALUE, COSTCENTER, TOTALFLATDISCOUNT, TOTALINDDISCOUNT, 
	TOTALLOYALTY, TOTALPROMOTION, NETWITHOUTROUNDOFF, guid, JOBNO, MWAREHOUSE, POSTID
	FROM    dbo.ACCMAIN WITH (NOLOCK)	WHERE PhiscalId	LIKE @PhiscalId

	UNION ALL
	SELECT  VCHRNO, DIVISION, CHALANNO, TRNDATE, BSDATE, TRNTIME, TOTAMNT, DCAMNT, DCRATE, VATAMNT, NETAMNT, ADVANCE, TRNMODE, BILLTO, BILLTOADD, TRNUSER, VATBILL, DELIVERYDATE, 
	DELIVERYTIME, ORDERS, REFORDBILL, INDDIS, CREBATE, CREDIT, DUEDATE, TRNAC, PARAC, PARTRNAMNT, RETTO, REFBILL, CHEQUENO, CHEQUEDATE, REMARKS, POST, POSTUSER, FPOSTUSER, 
	TERMINAL, SHIFT, EXPORT, CHOLDER, CARDNO, EditUser, MEMBERNO, MEMBERNAME, EDITED, TAXABLE, NONTAXABLE, VMODE, BILLTOTEL, BILLTOMOB, TRN_DATE, BS_DATE, STAX, TOTALCASH, 
	TOTALCREDIT, TOTALCREDITCARD, TOTALGIFTVOUCHER, TENDER, CHANGE, CardTranID, ReturnVchrID, TranID, VoucherStatus, VoucherType, PRESCRIBEBY, DISPENSEBY, RECEIVEBY, Edate, STATUS, 
	CONFIRMEDBY, CONFIRMEDTIME, PhiscalID, Stamp, ROUNDOFF, Customer_Count, DBUSER, HOSTID, VNUM, TOTALREBATE, DISVALUE, STAXVALUE, COSTCENTER, TOTALFLATDISCOUNT, TOTALINDDISCOUNT, 
	TOTALLOYALTY, TOTALPROMOTION, NETWITHOUTROUNDOFF, guid, JOBNO, MWAREHOUSE, POSTID
	FROM    dbo.INVMAIN WITH (NOLOCK)	WHERE PhiscalId	LIKE @PhiscalId

	UNION ALL
	SELECT  VCHRNO, DIVISION, CHALANNO, TRNDATE, BSDATE, TRNTIME, TOTAMNT, DCAMNT, DCRATE, VATAMNT, NETAMNT, ADVANCE, TRNMODE, BILLTO, BILLTOADD, TRNUSER, VATBILL, DELIVERYDATE, 
	DELIVERYTIME, ORDERS, REFORDBILL, INDDIS, CREBATE, CREDIT, DUEDATE, TRNAC, PARAC, PARTRNAMNT, RETTO, REFBILL, CHEQUENO, CHEQUEDATE, REMARKS, POST, POSTUSER, FPOSTUSER, 
	TERMINAL, SHIFT, EXPORT, CHOLDER, CARDNO, EditUser, MEMBERNO, MEMBERNAME, EDITED, TAXABLE, NONTAXABLE, VMODE, BILLTOTEL, BILLTOMOB, TRN_DATE, BS_DATE, STAX, TOTALCASH, 
	TOTALCREDIT, TOTALCREDITCARD, TOTALGIFTVOUCHER, TENDER, CHANGE, CardTranID, ReturnVchrID, TranID, VoucherStatus, VoucherType, PRESCRIBEBY, DISPENSEBY, RECEIVEBY, Edate, STATUS, 
	CONFIRMEDBY, CONFIRMEDTIME, PhiscalID, Stamp, ROUNDOFF, Customer_Count, DBUSER, HOSTID, VNUM, TOTALREBATE, DISVALUE, STAXVALUE, COSTCENTER, TOTALFLATDISCOUNT, TOTALINDDISCOUNT, 
	TOTALLOYALTY, TOTALPROMOTION, NETWITHOUTROUNDOFF, guid, JOBNO, MWAREHOUSE, POSTID
	FROM    dbo.PURMAIN WITH (NOLOCK) WHERE PhiscalId	LIKE @PhiscalId
                          
	UNION ALL
	SELECT  VCHRNO, DIVISION, CHALANNO, TRNDATE, BSDATE, TRNTIME, TOTAMNT, DCAMNT, DCRATE, VATAMNT, NETAMNT, ADVANCE, TRNMODE, BILLTO, BILLTOADD, TRNUSER, VATBILL, DELIVERYDATE, 
	DELIVERYTIME, ORDERS, REFORDBILL, INDDIS, CREBATE, CREDIT, DUEDATE, TRNAC, PARAC, PARTRNAMNT, RETTO, REFBILL, CHEQUENO, CHEQUEDATE, REMARKS, POST, POSTUSER, FPOSTUSER, 
	TERMINAL, SHIFT, EXPORT, CHOLDER, CARDNO, EditUser, MEMBERNO, MEMBERNAME, EDITED, TAXABLE, NONTAXABLE, VMODE, BILLTOTEL, BILLTOMOB, TRN_DATE, BS_DATE, STAX, TOTALCASH, 
	TOTALCREDIT, TOTALCREDITCARD, TOTALGIFTVOUCHER, TENDER, CHANGE, CardTranID, ReturnVchrID, TranID, VoucherStatus, VoucherType, PRESCRIBEBY, DISPENSEBY, RECEIVEBY, Edate, STATUS, 
	CONFIRMEDBY, CONFIRMEDTIME, PhiscalID, Stamp, ROUNDOFF, Customer_Count, DBUSER, HOSTID, VNUM, TOTALREBATE, DISVALUE, STAXVALUE, COSTCENTER, TOTALFLATDISCOUNT, TOTALINDDISCOUNT, 
	TOTALLOYALTY, TOTALPROMOTION, NETWITHOUTROUNDOFF, guid, JOBNO, MWAREHOUSE, POSTID
	FROM    dbo.GRNMAIN WITH (NOLOCK) WHERE VoucherType = 'GR' AND @GRNWISE = 1 AND PhiscalId	LIKE @PhiscalId

	UNION ALL
	SELECT  VCHRNO, DIVISION, CHALANNO, TRNDATE, BSDATE, TRNTIME, TOTAMNT, DCAMNT, DCRATE, VATAMNT, NETAMNT, ADVANCE, TRNMODE, BILLTO, BILLTOADD, TRNUSER, VATBILL, DELIVERYDATE, 
	DELIVERYTIME, ORDERS, REFORDBILL, INDDIS, CREBATE, CREDIT, DUEDATE, TRNAC, PARAC, PARTRNAMNT, RETTO, REFBILL, CHEQUENO, CHEQUEDATE, REMARKS, POST, POSTUSER, FPOSTUSER, 
	TERMINAL, SHIFT, EXPORT, CHOLDER, CARDNO, EditUser, MEMBERNO, MEMBERNAME, EDITED, TAXABLE, NONTAXABLE, VMODE, BILLTOTEL, BILLTOMOB, TRN_DATE, BS_DATE, STAX, TOTALCASH, 
	TOTALCREDIT, TOTALCREDITCARD, TOTALGIFTVOUCHER, TENDER, CHANGE, CardTranID, ReturnVchrID, TranID, VoucherStatus, VoucherType, PRESCRIBEBY, DISPENSEBY, RECEIVEBY, Edate, STATUS, 
	CONFIRMEDBY, CONFIRMEDTIME, PhiscalID, Stamp, ROUNDOFF, Customer_Count, DBUSER, HOSTID, VNUM, TOTALREBATE, DISVALUE, STAXVALUE, COSTCENTER, TOTALFLATDISCOUNT, TOTALINDDISCOUNT, 
	TOTALLOYALTY, TOTALPROMOTION, NETWITHOUTROUNDOFF, guid, JOBNO, MWAREHOUSE, POSTID
	FROM    dbo.AOPMAIN WITH (NOLOCK) WHERE PhiscalId	LIKE @PhiscalId	 

	UNION ALL
	SELECT  VCHRNO, DIVISION, CHALANNO, TRNDATE, BSDATE, TRNTIME, TOTAMNT, DCAMNT, DCRATE, VATAMNT, NETAMNT, ADVANCE, TRNMODE, BILLTO, BILLTOADD, TRNUSER, VATBILL, DELIVERYDATE, 
	DELIVERYTIME, ORDERS, REFORDBILL, INDDIS, CREBATE, CREDIT, DUEDATE, TRNAC, PARAC, PARTRNAMNT, RETTO, REFBILL, CHEQUENO, CHEQUEDATE, REMARKS, POST, POSTUSER, FPOSTUSER, 
	TERMINAL, SHIFT, EXPORT, CHOLDER, CARDNO, EditUser, MEMBERNO, MEMBERNAME, EDITED, TAXABLE, NONTAXABLE, VMODE, BILLTOTEL, BILLTOMOB, TRN_DATE, BS_DATE, STAX, TOTALCASH, 
	TOTALCREDIT, TOTALCREDITCARD, TOTALGIFTVOUCHER, TENDER, CHANGE, CardTranID, ReturnVchrID, TranID, VoucherStatus, VoucherType, PRESCRIBEBY, DISPENSEBY, RECEIVEBY, Edate, STATUS, 
	CONFIRMEDBY, CONFIRMEDTIME, PhiscalID, Stamp, ROUNDOFF, Customer_Count, DBUSER, HOSTID, VNUM, TOTALREBATE, DISVALUE, STAXVALUE, COSTCENTER, TOTALFLATDISCOUNT, TOTALINDDISCOUNT, 
	TOTALLOYALTY, TOTALPROMOTION, NETWITHOUTROUNDOFF, guid, JOBNO, MWAREHOUSE, POSTID
	FROM    dbo.OPMAIN WITH (NOLOCK) WHERE PhiscalId	LIKE @PhiscalId	 
)
