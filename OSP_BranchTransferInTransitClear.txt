CREATE OR ALTER PROCEDURE [dbo].[OSP_BranchTransferInTransitClear]
@TOVCHRNO VARCHAR(50)
AS
DECLARE @VCHRNO VARCHAR(25)
SELECT @VCHRNO =  VCHRNO FROM INVMAIN_TMP WHERE REFBILL = @TOVCHRNO
BEGIN TRANSACTION
	INSERT INTO INVMAIN
	(
		VCHRNO, DIVISION, CHALANNO, TRNDATE, BSDATE, TRNTIME,TOTAMNT, DCAMNT, DCRATE,  VATAMNT,  NETAMNT,ADVANCE,  TRNMODE, BILLTO, BILLTOADD, TRNUSER, 
		VATBILL, DELIVERYDATE, DELIVERYTIME, ORDERS, REFORDBILL, INDDIS, CREBATE, CREDIT, DUEDATE, TRNAC, PARAC, PARTRNAMNT, RETTO, REFBILL, CHEQUENO, 
		CHEQUEDATE, REMARKS, POST, POSTUSER, FPOSTUSER, TERMINAL, SHIFT, EXPORT, CHOLDER, CARDNO, EditUser, MEMBERNO, MEMBERNAME, EDITED, TAXABLE, NONTAXABLE, 
		VMODE, BILLTOTEL, BILLTOMOB, TRN_DATE, BS_DATE, STAX, TOTALCASH, TOTALCREDIT, TOTALCREDITCARD, TOTALGIFTVOUCHER, TENDER, CHANGE, CardTranID, 
		ReturnVchrID, TranID, VoucherStatus, VoucherType, PRESCRIBEBY, DISPENSEBY, RECEIVEBY, Edate, STATUS, CONFIRMEDBY, CONFIRMEDTIME, PhiscalID, 
		Stamp,ROUNDOFF, Customer_Count, DBUSER, VNUM,TOTALREBATE,DISVALUE,STAXVALUE,TOTALFLATDISCOUNT,TOTALINDDISCOUNT,TOTALLOYALTY,TOTALPROMOTION,
		NETWITHOUTROUNDOFF,COSTCENTER,guid,JOBNO,MWAREHOUSE,POSTID,TOTALRATEDISCOUNT,ORDERMODE
	)
	SELECT
		VCHRNO, DIVISION, CHALANNO, TRNDATE, BSDATE, TRNTIME,TOTAMNT, DCAMNT, DCRATE,  VATAMNT,  NETAMNT,ADVANCE,  TRNMODE, BILLTO, BILLTOADD, TRNUSER, 
		VATBILL, DELIVERYDATE, DELIVERYTIME, ORDERS, REFORDBILL, INDDIS, CREBATE, CREDIT, DUEDATE, TRNAC, PARAC, PARTRNAMNT, RETTO, REFBILL, CHEQUENO, 
		CHEQUEDATE, REMARKS, POST, POSTUSER, FPOSTUSER, TERMINAL, SHIFT, EXPORT, CHOLDER, CARDNO, EditUser, MEMBERNO, MEMBERNAME, EDITED, TAXABLE, NONTAXABLE, 
		VMODE, BILLTOTEL, BILLTOMOB, TRN_DATE, BS_DATE, STAX, TOTALCASH, TOTALCREDIT, TOTALCREDITCARD, TOTALGIFTVOUCHER, TENDER, CHANGE, CardTranID, 
		ReturnVchrID, TranID, VoucherStatus, VoucherType, PRESCRIBEBY, DISPENSEBY, RECEIVEBY, Edate, STATUS, CONFIRMEDBY, CONFIRMEDTIME, PhiscalID, 
		Stamp,ROUNDOFF, Customer_Count, DBUSER, VNUM,TOTALREBATE,DISVALUE,STAXVALUE,TOTALFLATDISCOUNT,TOTALINDDISCOUNT,TOTALLOYALTY,TOTALPROMOTION,
		NETWITHOUTROUNDOFF,COSTCENTER,guid,JOBNO,MWAREHOUSE,POSTID,TOTALRATEDISCOUNT,ORDERMODE FROM INVMAIN_TMP WHERE VCHRNO = @VCHRNO


	INSERT INTO INVPROD 
	(
		VCHRNO,CHALANNO,DIVISION,MCODE,UNIT,Quantity,RealQty,AltQty,RATE,AMOUNT,DISCOUNT,VAT,REALRATE,EXPORT,IDIS,OPQTY,REALQTY_IN,ALTQTY_IN,WAREHOUSE,
		REFBILLQTY,SPRICE,EXPDATE,REFOPBILL,ALTUNIT,TRNAC,PRATE,VRATE,ALTRATE,VPRATE,VSRATE,TAXABLE,NONTAXABLE,INVRATE,EXRATE,NCRATE,CRATE,SNO,CUSTOM,WEIGHT,
		DRATE,CARTON,INVOICENO,ISSUENO,BC,GENERIC,BATCH,MFGDATE,MANUFACTURER,SERVICETAX,BCODEID,VoucherType,SALESMANID,PhiscalID,STAMP,ITEMDESC,ADDTIONALROW,
		COSTCENTER,ISVAT,PROMOTION,LOYALTY,INDDISCOUNT,FLATDISCOUNT,NETAMOUNT,PRODCONDITION,PRODMODE, ITEMTYPE, RECEIVEDTYPE, REMARKS,SCHEMESAPPLIED,RATEDISCOUNT
	)
	SELECT 
		 VCHRNO,CHALANNO,DIVISION,MCODE,UNIT,Quantity,RealQty,AltQty,RATE,AMOUNT,DISCOUNT,VAT,REALRATE,EXPORT,IDIS,OPQTY,REALQTY_IN,ALTQTY_IN,WAREHOUSE,
		 REFBILLQTY,SPRICE,EXPDATE,REFOPBILL,ALTUNIT,TRNAC,PRATE,VRATE,ALTRATE,VPRATE,VSRATE,TAXABLE,NONTAXABLE,INVRATE,EXRATE,NCRATE,CRATE,SNO,CUSTOM,WEIGHT,
		 DRATE,CARTON,INVOICENO,ISSUENO,BC,GENERIC,BATCH,MFGDATE,MANUFACTURER,SERVICETAX,BCODEID,VoucherType,SALESMANID,PhiscalID,STAMP,ITEMDESC,ADDTIONALROW,
		 COSTCENTER,ISVAT,PROMOTION,LOYALTY,INDDISCOUNT,FLATDISCOUNT,NETAMOUNT,PRODCONDITION,PRODMODE, ITEMTYPE, RECEIVEDTYPE, REMARKS,SCHEMESAPPLIED,RATEDISCOUNT
		 FROM INVPROD_TMP WHERE VCHRNO = @VCHRNO
COMMIT TRANSACTION
