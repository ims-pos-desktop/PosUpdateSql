IF EXISTS (SELECT * from INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'tblMasterSequences' AND COLUMN_NAME = 'VNAME' AND IS_NULLABLE='YES')
ALTER TABLE tblMasterSequences ALTER COLUMN VNAME VARCHAR(15) NOT NULL

IF EXISTS (SELECT VNAME, COUNT(*) RN FROM tblMasterSequences GROUP BY VNAME HAVING COUNT(*) > 1)
BEGIN
;WITH CTE AS
(
	SELECT ROW_NUMBER() OVER (PARTITION BY VNAME ORDER BY VNAME) RN, * FROM tblMasterSequences
)
DELETE FROM CTE WHERE RN > 1
END