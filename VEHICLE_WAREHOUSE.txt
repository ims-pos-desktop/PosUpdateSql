CREATE OR ALTER VIEW [dbo].[VEHICLE_WAREHOUSE]
AS
SELECT BC, WAREHOUSE FROM
(
SELECT MCODE,  BC, WAREHOUSE, REALQTY_IN, RealQty FROM RMD_TRNPROD P
union all
SELECT MCODE, BC, WAREHOUSE, REALQTY_IN, RealQty FROM GRNPROD
)P JOIN MENUITEM MI ON P.MCODE = MI.MCODE
WHERE MI.PTYPE = 4
GROUP BY BC, WAREHOUSE
HAVING SUM(REALQTY_IN - REALQTY) > 0
